(this.webpackJsonpadmin=this.webpackJsonpadmin||[]).push([[0],{118:function(e,t){e.exports={username:[{required:!0,message:"\u7528\u6237\u540d\u5fc5\u987b\u586b\u5199"},{min:4,message:"\u7528\u6237\u540d\u6700\u5c114\u4e2a\u5b57"},{max:32,message:"\u7528\u6237\u540d\u6700\u957f32\u4e2a\u5b57"},{type:"string",pattern:/^\w{4,32}$/,message:"\u7528\u6237\u540d\u5fc5\u987b\u4ec5\u5305\u542b\u6570\u5b57\u5b57\u6bcd\u3001\u4e0b\u5212\u7ebf"}],password:[{required:!0,message:"\u5bc6\u7801\u5fc5\u987b\u586b\u5199"},{min:6,message:"\u5bc6\u7801\u957f\u5ea6\u6700\u5c116"}]}},165:function(e,t,a){e.exports=a(334)},334:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(7),c=a.n(o),l=a(112),i=a.n(l);a(171),a(172),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var s=a(81),u=a(40),p=a(53),m={token:localStorage.getItem("token"),token_expires:localStorage.getItem("token_expires"),authority:JSON.parse(localStorage.getItem("authority"))},d=a(41),h=a.n(d),f=a(147),y=a.n(f),g=a(341),E=a(39),x=a(340),v=a(338),k=a(339),b=v.a.create()((function(e){var t=e.form,a=t.resetFields,o=t.getFieldDecorator,c=t.validateFields,l=Object(n.useState)(!1),i=Object(p.a)(l,2),s=i[0],u=i[1],m=(0,Object(n.useContext)(M).useMapAction)("createShop");return r.a.createElement("div",null,r.a.createElement(E.a,{onClick:function(){return u(!0)}},"\u521b\u5efa\u5e97\u94fa"),r.a.createElement(x.a,{title:"\u6dfb\u52a0",visible:s,onOk:function(){console.log("create shop"),c((function(e,t){e?console.log(e):(console.log(t),m(t).then((function(e){g.a.success("\u521b\u5efa\u6210\u529f"),u(!1)})).catch((function(e){console.log(e),g.a.error("\u521b\u5efa\u5931\u8d25")})))}))},onCancel:function(){u(!1),a()}},r.a.createElement(v.a,null,r.a.createElement(v.a.Item,null,o("shopName",{rules:[{required:!0,message:"\u5e97\u94fa\u540d\u79f0\u5fc5\u987b\u586b\u5199"}]})(r.a.createElement(k.a,{type:"text",placeholder:"\u8bf7\u8f93\u5165\u5e97\u94fa\u7684\u540d\u79f0"}))),r.a.createElement(v.a.Item,null,o("address",{})(r.a.createElement(k.a,{type:"text",placeholder:"\u8bf7\u8f93\u5165\u5e97\u94fa\u7684\u5730\u5740"}))),r.a.createElement(v.a.Item,null,o("tel",{})(r.a.createElement(k.a,{type:"text",placeholder:"\u8bf7\u8f93\u5165\u5e97\u94fa\u7684\u7535\u8bdd"}))),r.a.createElement(v.a.Item,null,o("opentime",{})(r.a.createElement(k.a,{type:"text",placeholder:"\u8bf7\u8f93\u5165\u5e97\u94fa\u7684\u8425\u4e1a\u65f6\u95f4"}))))))})),w=function(){return r.a.createElement("div",null,r.a.createElement(E.a,{type:"primary"},"\u6dfb\u52a0\u7ba1\u5b50\u7406\u5458"),r.a.createElement(E.a,{type:"primary"},"\u5220\u9664\u7ba1\u5b50\u7406\u5458"))},O=function(){return r.a.createElement("div",null,r.a.createElement(E.a,{type:"primary"},"\u6dfb\u52a0\u5546\u54c1"),r.a.createElement(E.a,{type:"primary"},"\u7f16\u8f91\u5546\u54c1"),r.a.createElement(E.a,{type:"primary"},"\u5220\u9664\u5546\u54c1"))},I=y.a.create({baseURL:"https://www.soamazing.cn/api",headers:{token:localStorage.getItem("token")}}),S={register:function(e,t){var a,n;return h.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return e.dispatch,r.next=3,h.a.awrap(I.post("/admin/register",t));case 3:return a=r.sent,n=a.data,r.abrupt("return",n);case 6:case"end":return r.stop()}}))},login:function(e,t){var a,n,r,o,c,l;return h.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return a=e.dispatch,i.next=3,h.a.awrap(I.post("/admin/login",t));case 3:return n=i.sent,r=n.data,o=r.token,c=r.token_expires,l=r.authority,localStorage.setItem("token",o),localStorage.setItem("token_expires",c),localStorage.setItem("authority",JSON.stringify(l)),console.log(l),a({type:"setToken",payload:{token:o,token_expires:c,authority:l}}),i.abrupt("return",r);case 12:case"end":return i.stop()}}))},getMenus:function(e,t){var a,n,r;return h.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.state.authority,e.dispatch,n=[{title:"\u9996\u9875",icon:"index",path:"/index",exact:!0,component:b},{title:"\u56e2\u961f\u7ba1\u7406",icon:"team",path:"/index/team",component:w,authority:"team"},{title:"\u5546\u54c1\u7ba1\u7406",icon:"shopping",path:"/index/goods",component:O,authority:"goods"}],r=Object.keys(a),t.abrupt("return",n.map((function(e){if(!e.authority||r.includes(e.authority))return e})).filter((function(e){return e})));case 4:case"end":return t.stop()}}))},createShop:function(e,t){var a,n;return h.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.awrap(I.post("/admin/shop",t));case 2:return a=e.sent,n=a.data,e.abrupt("return",n);case 5:case"end":return e.stop()}}))}},j=a(159),C={setToken:function(e,t){return Object(j.a)({},e,{},t)}},M=r.a.createContext({});function F(e,t){var a=t.type,n=t.payload;return C[a](e,n)}var A=a(336),_=a(118),J=a.n(_),N=v.a.create()((function(e){var t=e.history,a=e.form,o=a.getFieldDecorator,c=a.validateFields,l=J.a.username,i=J.a.password,s=Object(n.useContext)(M).useMapAction,u=s("register"),p=s("login");return r.a.createElement(A.a,{title:"\u767b\u5f55",className:"dialog"},r.a.createElement(v.a,null,r.a.createElement(v.a.Item,null,o("username",{rules:l})(r.a.createElement(k.a,{type:"text",placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u540d"}))),r.a.createElement(v.a.Item,null,o("password",{rules:i})(r.a.createElement(k.a,{type:"password",placeholder:"\u8bf7\u8f93\u5165\u5bc6\u7801"}))),r.a.createElement(v.a.Item,null,r.a.createElement(E.a,{type:"primary",onClick:function(){c((function(e,a){p(a).then((function(e){var a=e.err,n=e.res;a?alert(n):t.push("/index")}))}))}},"\u767b\u5f55"),r.a.createElement(E.a,{type:"default",onClick:function(){c((function(e,t){console.log("error",e),console.log("values",t),u(t).then((function(e){var t=e.err,a=e.res;console.log("register",a),t?alert(a):alert(a+"\u8bf7\u767b\u5f55")}))}))}},"\u6ce8\u518c"))))})),q=a(335),R=a(337),z=a(10),B=q.a.Sider,D=q.a.Content,T=q.a.Footer,W=function(e){var t=e.history,a=e.location,o=(0,Object(n.useContext)(M).useMapAction)("getMenus"),c=Object(n.useState)([]),l=Object(p.a)(c,2),i=l[0],s=l[1];return Object(n.useEffect)((function(){o().then((function(e){return s(e)}))}),[]),r.a.createElement(q.a,{style:{minHeight:"100vh"}},r.a.createElement(B,{collapsible:!0},r.a.createElement(R.a,{theme:"dark",mode:"inline",defaultSelectedKeys:[a.pathname],onClick:function(e){return t.push(e.key)}},i.map((function(e){return r.a.createElement(R.a.Item,{key:e.path},r.a.createElement(z.a,{type:e.icon}),r.a.createElement("span",null,e.title))})))),r.a.createElement(q.a,null,r.a.createElement(D,null,r.a.createElement(u.c,null,i.map((function(e){return r.a.createElement(u.a,{key:e.path,path:e.path,exact:e.exact,component:e.component})})))),r.a.createElement(T,{style:{textAlign:"center"}},"xxx\u516c\u53f8\u7248\u6743\u6240\u6709")))};i.a.locale("zh-cn"),c.a.render(r.a.createElement((function(e){var t=Object(n.useReducer)(F,m),a=Object(p.a)(t,2),o=a[0],c=a[1];return r.a.createElement(M.Provider,{value:{state:o,useMapAction:function(e){var t=S[e];return function(e){return t({state:o,dispatch:c},e)}},useMapReducer:function(e){return function(t){return c({type:e,payload:t})}}}},e.children)}),null,r.a.createElement(s.a,null,r.a.createElement(u.a,{component:function(e){console.log("app");var t=e.history,a=Object(n.useContext)(M).state.token;return Object(n.useEffect)((function(){a?t.push("/index"):t.push("/login")}),[]),r.a.createElement(u.c,null,r.a.createElement(u.a,{key:"index",path:"/index",component:W}),r.a.createElement(u.a,{key:"login",path:"/login",component:N}))}}))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[165,1,2]]]);
//# sourceMappingURL=main.3b692dc2.chunk.js.map